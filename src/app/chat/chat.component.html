<div
  class="container w-100 h-100"
  fxLayout="column"
  fxLayoutAlign="center center"
>
  <div
    class="chat-window"
    fxLayout="column"
    fxLayoutAlign="space-between center"
  >
    <h1 class="chat-header">
      ConstitucionGPT
      <svg
      class="chat-header-icon"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 87 81"
        fill="none"
      >
        <g clip-path="url(#clip0_7_17)">
          <path
            d="M11.788 64.1797C10.8773 64.0432 9.93018 64.1285 9.00251 63.953C3.79343 62.968 0.0365881 58.6916 0.0268742 53.5302C-0.00469596 39.2529 -0.00955291 24.978 0.0268742 10.7006C0.041445 4.66398 4.88625 0.0170203 11.1104 0.0121441C32.7287 -0.00492234 54.3445 -0.00492234 75.9628 0.0145822C82.2136 0.0194584 87.0026 4.75663 87.0002 10.8274C87.0002 24.9024 87.0002 38.9774 87.0002 53.0524C87.0002 59.5522 82.3108 64.1139 75.6106 64.1188C64.2551 64.1261 52.8996 64.1261 41.544 64.1066C40.7086 64.1066 40.0287 64.2919 39.3365 64.7722C31.9613 69.9092 24.5569 75.0072 17.1792 80.1417C16.0281 80.9439 14.8673 81.3193 13.551 80.6586C12.2275 79.9955 11.8924 78.8252 11.8997 77.4696C11.9215 73.3907 11.9094 69.3118 11.9045 65.2329C11.9045 64.8965 11.9798 64.5479 11.7904 64.1773L11.788 64.1797ZM17.949 72.1766C18.3618 72.1936 18.5197 72.0035 18.7067 71.8743C24.875 67.6125 31.0482 63.3556 37.1995 59.0744C38.0082 58.5112 38.8411 58.2454 39.832 58.2454C51.7217 58.2601 63.6115 58.2552 75.5038 58.2528C78.9741 58.2528 80.9581 56.3316 80.9605 52.9719C80.9605 38.9798 80.9605 24.9877 80.9605 10.9981C80.9605 10.4227 80.9363 9.85219 80.7541 9.29388C80.0207 7.07036 78.1945 5.87083 75.5062 5.87083C54.2401 5.87083 32.9739 5.87083 11.7078 5.87083C8.02869 5.87083 6.04948 7.78227 6.04948 11.337C6.04948 25.1267 6.04948 38.9189 6.04948 52.7086C6.04948 52.967 6.0422 53.2255 6.05434 53.4839C6.16362 56.234 8.24482 58.2113 11.0837 58.2479C12.2955 58.2625 13.5097 58.2406 14.7216 58.2552C16.7153 58.2796 17.932 59.4547 17.9441 61.3784C17.9587 63.3605 17.949 65.3427 17.9514 67.3248C17.9514 68.9266 17.9514 70.5284 17.9514 72.1741L17.949 72.1766Z"
            fill="#1D3556"
          />
          <path
            d="M4.46109 32.3361C4.46109 39.6479 4.46109 46.9572 4.46109 54.269C4.46109 54.5445 4.45381 54.82 4.46595 55.0955C4.58009 58.0236 6.75114 60.1326 9.70659 60.1691C10.9694 60.1862 12.2346 60.1618 13.4999 60.1764C15.5786 60.2033 16.8463 61.4564 16.8584 63.5044C16.873 65.6158 16.8657 67.7271 16.8657 69.8385C16.8657 71.5452 16.8657 73.2518 16.8657 75.0048C17.2956 75.0219 17.4607 74.8195 17.655 74.683C24.0831 70.1433 30.5186 65.6085 36.9322 61.0468C37.7749 60.4471 38.6443 60.1618 39.6764 60.1642C52.0713 60.1789 64.4638 60.174 76.8587 60.1716C80.4771 60.1716 82.5437 58.126 82.5462 54.5469C82.5462 47.1425 82.5462 39.7381 82.5462 32.3337H4.46109V32.3361Z"
            fill="#EA2F46"
          />
          <path
            d="M76.9388 4.38122C76.9121 4.38122 76.8903 4.37634 76.8636 4.37634C54.6965 4.37634 32.5294 4.37634 10.3599 4.37634C10.3356 4.37634 10.3137 4.38122 10.2894 4.38122H76.9388Z"
            fill="#FEFEFE"
          />
          <path
            d="M82.3349 8.02126C81.5796 5.67584 79.6976 4.40316 76.9388 4.37878H37.6267V32.3337H82.5486C82.5486 24.8342 82.5486 17.3347 82.5486 9.83519C82.5486 9.22079 82.5243 8.61371 82.3324 8.02126H82.3349Z"
            fill="#FEFEFE"
          />
          <path
            opacity="0.77"
            d="M82.3349 8.02126C81.5796 5.67584 79.6976 4.40316 76.9388 4.37878H37.6267V32.3337H82.5486C82.5486 24.8342 82.5486 17.3347 82.5486 9.83519C82.5486 9.22079 82.5243 8.61371 82.3324 8.02126H82.3349Z"
            fill="white"
          />
          <path
            d="M37.6268 4.38129H10.2895C6.50348 4.40811 4.46356 6.43658 4.46356 10.201C4.46356 17.5786 4.46356 24.9586 4.46356 32.3386H37.6292V4.38129H37.6268Z"
            fill="#FEFEFE"
          />
          <path
            opacity="0.77"
            d="M37.6268 4.38129H10.2895C6.50348 4.40811 4.46356 6.43658 4.46356 10.201C4.46356 17.5786 4.46356 24.9586 4.46356 32.3386H37.6292V4.38129H37.6268Z"
            fill="#050505"
          />
          <path
            opacity="0.77"
            d="M37.6268 4.38129H10.2895C6.50348 4.40811 4.46356 6.43658 4.46356 10.201C4.46356 17.5786 4.46356 24.9586 4.46356 32.3386H37.6292V4.38129H37.6268Z"
            fill="#004AA3"
          />
          <path
            d="M21.6814 11.0883L23.5634 14.7796C23.6679 14.9819 23.867 15.1233 24.0977 15.155L28.3038 15.7475C28.8866 15.8304 29.1198 16.5228 28.6972 16.9202L25.6543 19.7923C25.4868 19.9507 25.4115 20.1775 25.4504 20.4018L26.1692 24.4587C26.2687 25.0195 25.6592 25.4486 25.1395 25.1828L21.3778 23.2689C21.1714 23.1641 20.9237 23.1641 20.7173 23.2689L16.9556 25.1828C16.4359 25.4486 15.8263 25.0195 15.9259 24.4587L16.6447 20.4018C16.6836 20.1799 16.6083 19.9507 16.4407 19.7923L13.3978 16.9202C12.9753 16.5228 13.2084 15.8304 13.7913 15.7475L17.9974 15.155C18.2281 15.1233 18.4296 14.9819 18.5316 14.7796L20.4137 11.0883C20.6735 10.5763 21.4264 10.5763 21.6862 11.0883H21.6814Z"
            fill="white"
          />
        </g>
        <defs>
          <clipPath id="clip0_7_17">
            <rect width="87" height="81" fill="white" />
          </clipPath>
        </defs>
      </svg>
    </h1>
    <div class="chat-messages masked-overflow" #chatContainer>
      <div
        *ngFor="let message of messages"
        [ngClass]="message.sender + ' messages'"
        fxLayout="row"
        fxlLayoutAlign="center center"
      >
        <div [ngClass]="{ message: true, typewriter: message.isTyping }">
          <div class="message-content">
            {{ message.content
            }}<span *ngIf="message.isTyping" class="caret"></span>
          </div>
        </div>
        <div *ngIf="message.quote" class="quote">
          <button class="citation-button" (click)="viewCitation(message.quote)">
            <i class="pi pi-search-plus"></i>
          </button>
        </div>
        <div *ngIf="message.isThinking" fxLayout="row">
          <p class="loading-indicator">
            <i class="pi pi-spin pi-spinner"> </i>
            {{ loadingFlavorText + dots }}
          </p>
        </div>
      </div>
    </div>

    <div class="p-inputgroup chat-input">
      <input
        type="text"
        [(ngModel)]="newMessageContent"
        placeholder="EscrÃ­bele a ConstitucionGPT..."
        (keydown.enter)="sendMessage()"
      />
      <button
        [disabled]="loading"
        type="button"
        pButton
        icon="pi pi-send"
        (click)="sendMessage()"
        styleClass="p-button-warn"
      ></button>
    </div>
  </div>

  <app-citation-dialog #citationDialog></app-citation-dialog>
</div>

<p-toast position="top-center" [life]="7000"></p-toast>
